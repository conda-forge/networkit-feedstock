{% set name = "networkit" %}
{% set version = "11.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  - url: https://github.com/networkit/networkit/archive/{{ version }}.tar.gz
    sha256: 3cba54b384db4adfd88c984805647a3b74ed52168b6178cba6dd58f1cbd73120
    patches:
      - 0001-Pass-conda-python-version.patch
  - git_url: https://github.com/networkit/ttmath
    git_depth: 1
    folder: extlibs/ttmath

build:
  skip: true  # [py==27 or py==33  or python_impl == 'pypy']
  skip: true  # [py<38]
  number: 0
  script:
    - {{ PYTHON }} -m pip install --install-option="build_ext" --install-option="--networkit-external-core" --install-option="--external-tlx={{ BUILD_PREFIX }}" --ignore-installed -vv .    # [not win]
    - {{ PYTHON }} -m pip install --install-option="build_ext" --install-option="--external-tlx={{ BUILD_PREFIX }}\Library" --ignore-installed -vv .    # [win]

requirements:
  build:
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}
    - cmake >=3.5
    - cross-python_{{ target_platform }}  # [build_platform != target_platform]
    - cython >=0.29                       # [build_platform != target_platform]
    - libtlx
    - libnetworkit ={{ version }}         # [not win]
    - ninja >=1.9.0
    - numpy                               # [build_platform != target_platform]
    - pybind11                            # [build_platform != target_platform]
    - python                              # [build_platform != target_platform]
  host:
    - numpy
    - pip <23.0
    - python
    - scipy
    - setuptools <59.0
    - setuptools-cythonize
    - wheel >=0.28
    - libnetworkit ={{ version }}  # [not win]

  run:
    - numpy
    - python
    - scipy
    - libnetworkit ={{ version }}  # [not win]

test:
  requires:
    - conda-build
    - ipycytoscape
    - jupyter
    - plotly
    - seaborn
    - tabulate
  source_files:
    - networkit/test
    - notebooks
    - input
  commands:
    # Remove tests, which involve writing graphs (missing permissions)
    - rm networkit/test/test_graphio.py && rm networkit/test/extension/test.py
    - rm notebooks/User-Guide.ipynb
    - python -m unittest discover -v networkit/test/
    - python notebooks/test_notebooks.py "notebooks"

about:
  home: https://github.com/networkit/networkit
  license: MIT
  license_family: MIT
  license_file: License.txt
  summary: NetworKit is a growing open-source toolkit for large-scale network analysis.
  description: |
    NetworKit is a growing open-source toolkit for large-scale network analysis. Its aim is to provide tools for the analysis of large networks in the size range from thousands to billions of edges. For this purpose, it implements efficient graph algorithms, many of them parallel to utilize multicore architectures. These are meant to compute standard measures of network analysis, such as degree sequences, clustering coefficients, and centrality measures. In this respect, NetworKit is comparable to packages such as NetworkX, albeit with a focus on parallelism and scalability. NetworKit is also a testbed for algorithm engineering and contains novel algorithms from recently published research (see list of Publications).
  doc_url: https://networkit.github.io/
  dev_url: https://github.com/networkit/networkit

extra:
  recipe-maintainers:
    - angriman
    - avdgrinten
    - fabratu
    - lucventurini  # Temporary, I am not involved with the development itself
